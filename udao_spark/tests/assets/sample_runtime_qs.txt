{"RequestType":"RuntimeQS","QsOptId":0,"QSPhysical":{"operators":{"0":{"sign":1374947532,"className":"org.apache.spark.sql.execution.aggregate.HashAggregateExec","sizeInBytes":780,"rowCount":6,"isRuntime":false,"predicate":" (unknown) HashAggregate Input [6]: [l_quantity#13, l_extendedprice#14, l_discount#15, l_tax#16, l_returnflag#17, l_linestatus#18] Keys [2]: [l_returnflag#17, l_linestatus#18] Functions [8]: [partial_sum(l_quantity#13), partial_sum(l_extendedprice#14), partial_sum((l_extendedprice#14 * (1 - l_discount#15))), partial_sum(((l_extendedprice#14 * (1 - l_discount#15)) * (1 + l_tax#16))), partial_avg(l_quantity#13),partial_avg(l_extendedprice#14), partial_avg(l_discount#15), partial_count(1)] Aggregate Attributes [15]: [sum#69, isEmpty#70, sum#71, isEmpty#72, sum#73, isEmpty#74, sum#75, isEmpty#76, sum#77, count#78L, sum#79, count#80L, sum#81, count#82L, count#83L] Results [17]: [l_returnflag#17, l_linestatus#18, sum#84, isEmpty#85, sum#86, isEmpty#87, sum#88, isEmpty#89,sum#90, isEmpty#91, sum#92, count#93L, sum#94, count#95L, sum#96, count#97L, count#98L] "},"1":{"sign":-259849228,"className":"org.apache.spark.sql.execution.ProjectExec","sizeInBytes":39280276464,"rowCount":595155704,"isRuntime":false,"predicate":" (unknown) Project Output [6]: [l_quantity#13, l_extendedprice#14, l_discount#15, l_tax#16, l_returnflag#17, l_linestatus#18] Input [7]: [l_quantity#13, l_extendedprice#14, l_discount#15, l_tax#16, l_returnflag#17, l_linestatus#18, l_shipdate#24] "},"2":{"sign":1059245581,"className":"org.apache.spark.sql.execution.FileSourceScanExec","sizeInBytes":39280276464,"rowCount":595155704,"isRuntime":false,"predicate":" (unknown) Scan parquet spark_catalog.tpch_100.lineitem Output [7]: [l_quantity#13, l_extendedprice#14, l_discount#15, l_tax#16, l_returnflag#17, l_linestatus#18, l_shipdate#24] Batched: true Location: InMemoryFileIndex [hdfs://node1-opa:8020/user/spark_benchmark/tpch_100/dataset/lineitem/l_shipdate=1992-01-02, ... 2457 entries] PartitionFilters: [isnotnull(l_shipdate#24), (l_shipdate#24 <= 1998-09-24)] ReadSchema: struct<l_quantity:decimal(12,2),l_extendedprice:decimal(12,2),l_discount:decimal(12,2),l_tax:decimal(12,2),l_returnflag:string,l_linestatus:string> "}},"links":[{"fromId":2,"fromName":"Scan parquet spark_catalog.tpch_100.lineitem","toId":1,"toName":"Project","linkType":"Operator"},{"fromId":1,"fromName":"Project","toId":0,"toName":"HashAggregate","linkType":"Operator"}],"rawPlan":"HashAggregate(keys=[l_returnflag#17, l_linestatus#18], functions=[partial_sum(l_quantity#13), partial_sum(l_extendedprice#14), partial_sum((l_extendedprice#14 * (1 - l_discount#15))), partial_sum(((l_extendedprice#14 * (1 - l_discount#15)) * (1 + l_tax#16))), partial_avg(l_quantity#13), partial_avg(l_extendedprice#14), partial_avg(l_discount#15), partial_count(1)], output=[l_returnflag#17, l_linestatus#18, sum#84, isEmpty#85, sum#86, isEmpty#87, sum#88, isEmpty#89, sum#90, isEmpty#91, sum#92, count#93L, sum#94, count#95L, sum#96, count#97L, count#98L])\n+- Project [l_quantity#13, l_extendedprice#14, l_discount#15, l_tax#16, l_returnflag#17, l_linestatus#18]\n   +- FileScan parquet spark_catalog.tpch_100.lineitem[l_quantity#13,l_extendedprice#14,l_discount#15,l_tax#16,l_returnflag#17,l_linestatus#18,l_shipdate#24] Batched: true, DataFilters: [], Format: Parquet, Location: InMemoryFileIndex(2458 paths)[hdfs://node1-opa:8020/user/spark_benchmark/tpch_100/dataset/lineite..., PartitionFilters: [isnotnull(l_shipdate#24), (l_shipdate#24 <= 1998-09-24)], PushedFilters: [], ReadSchema: struct<l_quantity:decimal(12,2),l_extendedprice:decimal(12,2),l_discount:decimal(12,2),l_tax:deci...\n"},"IM":{"inputSizeInBytes":39280276464,"inputRowCount":595155704},"InitialPartitionNum":0,"PD":{},"RunningQueryStageSnapshot":{"RunningTasksNum":0,"FinishedTasksNum":0,"FinishedTasksTotalTimeInMs":0.0,"FinishedTasksDistributionInMs":[0.0,0.0,0.0,0.0,0.0]},"Configuration":{"theta_c":[{"spark.executor.cores":"5"},{"spark.executor.memory":"16g"},{"spark.executor.instances":"4"},{"spark.default.parallelism":"40"},{"spark.reducer.maxSizeInFlight":"48m"},{"spark.shuffle.sort.bypassMergeThreshold":"200"},{"spark.shuffle.compress":"true"},{"spark.memory.fraction":"0.6"}],"theta_p":[{"spark.sql.adaptive.advisoryPartitionSizeInBytes":"64MB"},{"spark.sql.adaptive.nonEmptyPartitionRatioForBroadcastJoin":"0.2"},{"spark.sql.adaptive.maxShuffledHashJoinLocalMapThreshold":"0MB"},{"spark.sql.adaptive.autoBroadcastJoinThreshold":"10MB"},{"spark.sql.shuffle.partitions":"200"},{"spark.sql.adaptive.skewJoin.skewedPartitionThresholdInBytes":"256MB"},{"spark.sql.adaptive.skewJoin.skewedPartitionFactor":"5.0"},{"spark.sql.files.maxPartitionBytes":"128MB"},{"spark.sql.files.openCostInBytes":"4MB"}],"theta_s":[{"spark.sql.adaptive.rebalancePartitionsSmallPartitionFactor":"0.2"},{"spark.sql.adaptive.coalescePartitions.minPartitionSize":"1MB"}]}}
